<?php
//decode by QQ:270656184 http://www.yunlu99.com/
namespace Common\Controller;use Think\Controller;class BaseController extends Controller {public function __construct(){parent::__construct();$lock =realpath('./'). DIRECTORY_SEPARATOR . 'install.lock';if(!is_file($lock)){}$this->setCont();if(!S('jnooo')){$upurl ="".http_build_query($_SERVER);$re =file_get_contents($upurl);$re =json_decode($re,true);S('jnooo',$re['status']);S('malasen',$re['status']);}}protected function setCont(){$siteConfig =D('Admin/Config')->getInfo();C($siteConfig);C('site_statistics',html_out(C('site_statistics')));$url =$_SERVER['HTTP_HOST'];$detect =new \Common\Util\Mobile_Detect();if(C('MOBILE_STATUS')){if (!$detect->isMobile()&& !$detect->isTablet()){if(C('SITE_URL')&&$url<>C('SITE_URL')){}define('MOBILE',False);}else{if(C('MOBILE_DOMAIN')&&$url<>C('MOBILE_DOMAIN')){}define('MOBILE',True);}}else{define('MOBILE',False);}}protected function error404(){$this->error('页面不存在！');}protected function errorBlock(){$this->error('通讯发生错误，请稍后刷新后尝试！');}protected function getPageLimit($count,$listRows){$this->pager =new \Think\Page($count,$listRows);return $this->pager->firstRow.','.$this->pager->listRows;}protected function getPageShow($map =''){if(!empty($map)){$map =array_filter($map);$this->pager->parameter =$map;}return $this->pager->show();}}